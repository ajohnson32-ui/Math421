---
title: "Assignment 7 - Visualization - Some aspects of ggplot2"
format: html
editor: visual
---

***How to do it?***:

-   Open the Rmarkdown file of this assignment ([link](assignment7.qmd)) in Rstudio.

-   Right under each **question**, insert a code chunk (you can use the hotkey `Ctrl + Alt + I` to add a code chunk) and code the solution for the question.

-   `Knit` the rmarkdown file (hotkey: `Ctrl + Alt + K`) to export an html.

-   Publish the html file to your Githiub Page.

***Submission***: Submit the link on Github of the assignment to Canvas

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
```

------------------------------------------------------------------------

Use the data of your own. Produce the following types of plots and comment on each plot. Plots should be meaningful. If you use the data we used in class, make sure the plots are not the same as the ones in the slides. All plots should have title, caption, appropriate labels on x and y-axis.

```{r}
library(ggplot2)
library(dplyr)
titanic <- read.csv("C:/Users/student/Downloads/titanic.csv")
```

------------------------------------------------------------------------

1.  Make a plot using `facet_wrap` by one categorical variable (`facet_wrap(~variable1)`)

    ```{r}
    ggplot(titanic, aes(x = Pclass)) +
      geom_bar(fill = "steelblue") +
      facet_wrap(~Sex) +
      labs(title = "Passenger Class Count by Sex", x = "Class", y = "Count")
    #This plot shows how passenger classes are distributed separately for males and females
    ```

2.  Make a plot using `facet_wrap` by two categorical variables (`facet_wrap(~variable1+variable2)`)

    ```{r}
    ggplot(titanic, aes(x = Pclass)) + geom_bar(fill = "lightgreen") + facet_wrap(~Sex + Survived) + labs(title = "Passenger Class Count by Sex and Survival", x = "Class", y = "Count")
    #Using two variables lets us see patterns like survival rates within each class and sex combination.
    ```

3.  Make a plot using `position ='dodge'`.

    ```{r}
    ggplot(titanic, aes(x = Pclass, fill = Sex)) +
      geom_bar(position = "dodge") +
      labs(title = "Passenger Count by Class and Sex (Dodge)", x = "Class", y = "Count")
    #This makes it easy to compare counts of males and females by class
    ```

4.  Make a plot using `position ='fill'`.

    ```{r}
    ggplot(titanic, aes(x = Pclass, fill = Sex)) +
      geom_bar(position = "fill") +
      labs(title = "Proportion of Sex by Class", x = "Class", y = "Proportion")
    #Instead of counts, this shows proportions by class
    ```

5.  Make a plot using `geom_col`.

    ```{r}
    avg_fare <- titanic %>%
      group_by(Pclass) %>%
      summarise(mean_fare = mean(Fare, na.rm = TRUE))

    ggplot(avg_fare, aes(x = Pclass, y = mean_fare)) +
      geom_col(fill = "coral") +
      labs(title = "Average Fare by Class", x = "Class", y = "Average Fare")
    #This is used to show average fare by class
    ```

6.  Change the theme of one of your plots.

    ```{r}
    ggplot(titanic, aes(x = Pclass, fill = Sex)) +
      geom_bar(position = "dodge") +
      theme_minimal() +
      labs(title = "Passenger Count by Class and Sex with Minimal Theme", x = "Class", y = "Count")
    #This removes background of the original graph
    ```

7.  Make a plot using combo filter + ggplot

    ```{r}
    titanic %>%
      filter(Pclass %in% c(1, 2)) %>%
      ggplot(aes(x = Pclass, fill = Sex)) +
      geom_bar(position = "dodge") +
      labs(title = "Count of 1st & 2nd Class Passengers by Sex", x = "Class", y = "Count")
    #This helps focus the plot 
    ```

8.  Make a plot using combo group_by + summarise + geom_col

    ```{r}
    avg_fare_sex <- titanic %>%
      group_by(Pclass, Sex) %>%
      summarise(mean_fare = mean(Fare, na.rm = TRUE))

    ggplot(avg_fare_sex, aes(x = Pclass, y = mean_fare, fill = Sex)) +
      geom_col(position = "dodge") +
      labs(title = "Average Fare by Class and Sex", x = "Class", y = "Average Fare")
    #This shows summarized data, comparing average fares between males and females within each class
    ```

9.  Save a plot and put a link of the plot to your Github Webpage. To link a plot `abc.png` you just need to insert the following on the README.md

```{r, eval=FALSE}
[Link to the plot](abc.png)
```

10. In this question, we will use the Covid19 vaccination data for the US. The data and data dictionary can be found at the below link:

-   [Data](https://bryantstats.github.io/math421/data/vaccinations-by-manufacturer.csv)

```{r}
library(tidyverse)
df <- read_csv('https://bryantstats.github.io/math421/data/vaccinations-by-manufacturer.csv')
```

`Geom_point` makes scatter plots, which plot two numeric (or Date) variables. A third categorical variable is often brought in for color. For example, we can compare different vaccine types used in the US by

```{r}
df %>% 
  filter(location=='United States') %>% 
  ggplot()+
  geom_point(mapping = aes(x = date, 
                                    y = total_vaccinations, 
                                    color = vaccine))
```

Do the follows.

-   Use `geom_point` to compare the vaccines used by date in Argentina in 2022.

    ```{r}
    argentina_2022 <- df %>%
      filter(location == "Argentina" & format(as.Date(date), "%Y") == "2022")
    ggplot(argentina_2022, aes(x = as.Date(date), y = vaccine)) +
      geom_point(color = "blue", alpha = 0.6) +
      labs(title = "COVID-19 Vaccines Used in Argentina in 2022",
           x = "Date",
           y = "Vaccine") +
      theme_minimal()
    #Each point represents a vaccine reported on a given date
    ```

-   Change `geom_point` to `geom_line` in the above codes to have the corresponding line plots.

    ```{r}
    ggplot(argentina_2022, aes(x = as.Date(date), y = vaccine, group = vaccine, color = vaccine)) +
      geom_line(size = 1) +
      labs(title = "COVID-19 Vaccines Used in Argentina in 2022",
           x = "Date",
           y = "Vaccine") +
      theme_minimal()
    #This shows trends over time instead of individual points
    ```

11. (Using the same dataset as in 10.) Sometime we need to do some calculations on the data before plotting. For example, the below codes is to compare the total vaccines (including all types of vaccines) by date between the US and the EU

```{r}
# the total vaccines (including all types of vaccines) by date
d1 <- df %>% 
  filter(location %in% c('United States', 'European Union')) %>% 
  group_by(date, location) %>% 
  summarise(total_vac2=sum(total_vaccinations, na.rm=TRUE))

# Plot
d1 %>% 
  ggplot()+
  geom_point(mapping=aes(x=date, 
                         y=total_vac2, 
                         color=location))
```

Notice that the above codes could be piped in one

```{r, eval=FALSE}
df %>% 
  filter(location %in% c('United States', 'European Union')) %>% 
  group_by(date, location) %>% 
  summarise(total_vac2=sum(total_vaccinations, na.rm=TRUE)) %>% 
  ggplot()+
  geom_point(mapping=aes(x=date, 
                         y=total_vac2, 
                         color=location))
```

Do the follows.

-   Use `geom_point` compare the total vaccines (including all types of vaccines) by date between countries/regions in Asia

    ```{r}
    unique(df$location)
    asian_countries <- c("Japan", "South Korea", "Hong Kong", "Nepal")
    df_asia <- df %>%
      filter(location %in% asian_countries)
    ggplot(df_asia, aes(x = as.Date(date), y = total_vaccinations, color = location)) +
      geom_point(alpha = 0.6) +
      labs(title = "Total COVID-19 Vaccinations Over Time in Asia",
           x = "Date",
           y = "Total Vaccinations",
           color = "Country/Region") +
      theme_minimal()
    #Each point shows total vaccines given on a date
    ```

-   Use `geom_point` compare the total vaccines (including all types of vaccines) by date between countries/regions in South America in 2021

```{r}
south_america <- c("Argentina", "Chile", "Ecuador", "Peru", "Uruguay")
df_sa_2021 <- df %>%
  filter(location %in% south_america & format(as.Date(date), "%Y") == "2021")
ggplot(df_sa_2021, aes(x = as.Date(date), y = total_vaccinations, color = location)) +
  geom_point(alpha = 0.6) +
  labs(title = "Total COVID-19 Vaccinations in South America (2021)",
       x = "Date",
       y = "Total Vaccinations",
       color = "Country/Region") +
  theme_minimal()
#Each point represents the total vaccines given on that date.
```
