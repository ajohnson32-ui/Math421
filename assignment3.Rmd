---
title: "Assignment 3"
author: "Andrew Johnson"
date: "`r Sys.Date()`"
output: html_document
---


***Submission***: Submit the link on Github of the assignment to Canvas under Assignment 3. 

-------

Problems
-------
 \

1. Create the following data frame

| Rank 	| Age 	| Name  	|
|:------	|:-----	|:-------	|
| 0    	| 28  	| Tom   	|
| 1    	| 34  	| Jack  	|
| 2    	| 29  	| Steve 	|
| 3    	| 42  	| Ricky 	|

```{r}
Rank <- c(0, 1, 2, 3)
Age  <- c(28, 34, 29, 42)
Name <- c("Tom", "Jack", "Steve", "Ricky")
df <- data.frame(Rank, Age, Name)
print(df)
```


2. Use `read.csv` to import the Covid19 Vaccination data from WHO: [link](https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv).

```{r}
data <- read.csv("us-states.csv")
```


2. Show the names of the variables in the data

```{r}
data = read.csv('https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv')
names(data)
```


3. How many columns and rows the data have? 

```{r}
nrow(data)
ncol(data)
```


4. How many missing values are there?  Show the missing values by columns.  What variable has the most number of missing values?

```{r}
sum(is.na(data))
colSums(is.na(data))
which.max(colSums(is.na(data)))
```

5. What is the class of the `date` column. Change the `date` columns to `date` type using the `as.Date` function. Show the new class of the `date` column. 

```{r}
class(data$date)
data$date <- as.Date(data$date)
class(data$date)
```

6. Capitalize the names of all the variables
```{r}
names(data) <- toupper(names(data))
names(data)
```

7. Find the average number of cases per day. Find the maximum cases a day.  
```{r}
mean(data$CASES, na.rm = TRUE)
max(data$CASES, na.rm = TRUE)
```

8. How many states are there in the data?  
```{r}
length(unique(data$STATE))
```

9. Create a new variable `weekdays` to store the weekday for each rows. 
```{r}
data$WEEKDAYS <- weekdays(data$DATE)
```

10. Create the categorical variable `death2` variable taking the values as follows

- `has_death` if there is a death that day
-  `no_death` if there is no death that day
```{r}
data$DEATH2 <- ifelse(data$DEATHS > 0, "has_death", "no_death")
```


Find the frequency and relative frequency of `no_death` and `has_death`. 
```{r}
table(data$DEATH2)
prop.table(table(data$DEATH2))
```

11. Find the first quartile (Q1), second quartile (Q2) and and third quartile (Q3) of the variable `death`. (Hint:  Use the `summary` function)
```{r}
summary(data$DEATHS)
q1 <- quantile(data$DEATHS, 0.25, na.rm = TRUE)
q2 <- quantile(data$DEATHS, 0.50, na.rm = TRUE)
q3 <- quantile(data$DEATHS, 0.75, na.rm = TRUE)

q1
q2
q3
```


12. Create the categorical variable `death3` variable taking the values as follows

- `low_death` if the number of deaths smaller than the 25 percentile (Q1)

- `mid_death` if the number of deaths from Q1 to Q3

- `high_death` if the number of deaths greater than Q3
```{r}
q1
q3
data$DEATH3 <- ifelse(data$DEATHS < q1, "low_death",
                      ifelse(data$DEATHS > q3, "high_death", 
                             "mid_death"))
table(data$DEATH3)
```


13. Find the average cases in Rhode Island in 2021
```{r}
ri_2021 <- subset(data, STATE == "Rhode Island" & format(DATE, "%Y") == "2021")
mean(ri_2021$CASES, na.rm = TRUE)
```

14. Find the median cases by weekdays in Rhode Island in 2021 
```{r}
tapply(ri_2021$CASES, ri_2021$WEEKDAYS, median, na.rm = TRUE)
```

15. Compare the median cases in Rhode Island in June, July, August and September in 2021. 

```{r}
months <- c("06", "07", "08", "09")
month_names <- c("June", "July", "August", "September")
results <- sapply(months, function(m) {
  median(ri_2021$CASES[format(ri_2021$DATE, "%m") == m], na.rm = TRUE)
})
names(results) <- month_names
results
```

16.  Find your own dataset, import it and implement the following functions on the data

- head
- str
- names
- mean, min, max
- table
- is.na
- colSums
- class
- cor
- by
- ifelse
- case_when

```{r}
titanic <- read.csv("C:/Users/student/Downloads/titanic.csv")
head(titanic)
str(titanic)
names(titanic)
mean(titanic$Age, na.rm = TRUE)
min(titanic$Age, na.rm = TRUE)
max(titanic$Age, na.rm = TRUE)
table(titanic$Pclass)
colSums(is.na(titanic))
class(titanic$Survived)
cor(titanic[, c("Age", "Fare", "SibSp", "Parch")], use = "complete.obs")
by(titanic$Age, titanic$Pclass, mean, na.rm = TRUE)
titanic$Adult <- ifelse(titanic$Age < 18, "Child", "Adult")
```

17.  In the dataset in #16, practice the follows.  You can reuse the code of 16. 

- Create a categorical variable from a continuous variable
- From one categorical variable, create a new categorical variable with fewer categories

```{r}
titanic$AgeGroup <- cut(titanic$Age,
                        breaks = c(-Inf, 12, 18, 60, Inf),
                        labels = c("Child", "Teen", "Adult", "Senior"))
table(titanic$AgeGroup, useNA = "ifany")
titanic$ClassGroup <- ifelse(titanic$Pclass == 1, "High", "Low")
titanic$ClassGroup <- factor(titanic$ClassGroup)
table(titanic$ClassGroup)

```

If you do not have a data, you can use [the titanic dataset](https://www.kaggle.com/competitions/titanic/overview), which can be downloaded at [this link](../data/titanic.csv)

